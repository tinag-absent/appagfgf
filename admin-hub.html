<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Hub â€” æµ·è•æ©Ÿé–¢</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#05070d;--panel:#0a0e16;--panel2:#0f1520;--border:#162030;--border2:#1e2d40;
  --cyan:#00d4ff;--cyan-dim:#001c28;--green:#00e676;--green-dim:#001e10;
  --yellow:#ffd740;--yellow-dim:#201800;--red:#ff5252;--red-dim:#200808;
  --purple:#ce93d8;--orange:#ff9800;--blue:#4fc3f7;
  --text:#cdd6e8;--text2:#6a7d94;--text3:#364858;
  --mono:'Share Tech Mono',monospace;--sans:'Noto Sans JP',sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text);font-family:var(--sans);font-size:13px;min-height:100vh;}
body::before{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:9999;
  background:
    repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(0,212,255,.008) 3px,rgba(0,212,255,.008) 4px),
    radial-gradient(ellipse at 20% 20%, rgba(0,212,255,.04) 0%, transparent 60%),
    radial-gradient(ellipse at 80% 80%, rgba(0,230,118,.03) 0%, transparent 60%);
}

/* Header */
.hdr{
  background:linear-gradient(90deg,#05070d,#080d18,#05070d);
  border-bottom:1px solid var(--border2);
  padding:0 32px;height:64px;display:flex;align-items:center;gap:16px;
  position:sticky;top:0;z-index:100;
}
.hdr-logo{
  width:36px;height:36px;border:1px solid var(--cyan);display:flex;align-items:center;
  justify-content:center;font-family:var(--mono);font-size:14px;color:var(--cyan);
  position:relative;flex-shrink:0;
}
.hdr-logo::before{content:'';position:absolute;inset:2px;border:1px solid var(--cyan);opacity:.3;}
.hdr-org{display:flex;flex-direction:column;}
.hdr-org-main{font-family:var(--mono);font-size:13px;color:var(--cyan);letter-spacing:.25em;}
.hdr-org-sub{font-family:var(--mono);font-size:9px;color:var(--text3);letter-spacing:.15em;margin-top:2px;}
.hdr-sep{flex:1;}
.hdr-time{font-family:var(--mono);font-size:11px;color:var(--text3);}
.hdr-status{display:flex;align-items:center;gap:6px;}
.hdr-status-dot{width:6px;height:6px;border-radius:50%;background:var(--green);box-shadow:0 0 6px var(--green);animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.6;transform:scale(.9)}}
.hdr-status-txt{font-family:var(--mono);font-size:10px;color:var(--green);letter-spacing:.1em;}

/* Layout */
.layout{max-width:1400px;margin:0 auto;padding:32px;}

/* System status strip */
.status-strip{
  display:flex;gap:1px;margin-bottom:32px;overflow:hidden;border:1px solid var(--border2);
}
.status-item{
  flex:1;background:var(--panel);padding:16px 20px;display:flex;flex-direction:column;gap:4px;
  border-right:1px solid var(--border);transition:background .15s;
}
.status-item:last-child{border-right:none;}
.status-item:hover{background:var(--panel2);}
.status-val{font-family:var(--mono);font-size:24px;font-weight:400;line-height:1;}
.status-lbl{font-family:var(--mono);font-size:9px;color:var(--text3);letter-spacing:.12em;text-transform:uppercase;}
.status-change{font-family:var(--mono);font-size:10px;margin-top:2px;}

/* Section */
.section{margin-bottom:32px;}
.section-header{
  display:flex;align-items:center;gap:12px;margin-bottom:16px;
  padding-bottom:10px;border-bottom:1px solid var(--border);
}
.section-line{width:3px;height:16px;flex-shrink:0;}
.section-title{font-family:var(--mono);font-size:11px;letter-spacing:.2em;text-transform:uppercase;}
.section-count{font-family:var(--mono);font-size:10px;color:var(--text3);margin-left:auto;}

/* Tool grid */
.tool-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px;}
.tool-card{
  background:var(--panel);border:1px solid var(--border);
  padding:18px 20px;cursor:pointer;text-decoration:none;display:block;
  transition:all .2s;position:relative;overflow:hidden;
}
.tool-card::before{
  content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:var(--accent);opacity:.6;
  transition:opacity .2s;
}
.tool-card:hover{background:var(--panel2);border-color:var(--border2);}
.tool-card:hover::before{opacity:1;}
.tool-card-icon{font-family:var(--mono);font-size:22px;color:var(--accent);margin-bottom:10px;line-height:1;}
.tool-card-title{font-size:14px;font-weight:500;color:var(--text);margin-bottom:4px;}
.tool-card-desc{font-size:11px;color:var(--text2);line-height:1.5;}
.tool-card-badge{
  position:absolute;top:12px;right:12px;
  font-family:var(--mono);font-size:9px;padding:2px 7px;
  border-radius:2px;letter-spacing:.08em;
}
.tool-card-new{
  position:absolute;top:12px;right:12px;
  background:var(--green-dim);border:1px solid var(--green);color:var(--green);
  font-family:var(--mono);font-size:8px;padding:2px 6px;letter-spacing:.1em;
}

/* Activity feed */
.activity-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.activity-panel{background:var(--panel);border:1px solid var(--border);}
.activity-head{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px;}
.activity-head-dot{width:6px;height:6px;border-radius:50%;background:var(--accent);}
.activity-head-title{font-family:var(--mono);font-size:10px;letter-spacing:.12em;text-transform:uppercase;}
.activity-body{padding:12px 16px;}
.activity-row{display:flex;gap:10px;padding:7px 0;border-bottom:1px solid var(--border);align-items:flex-start;}
.activity-row:last-child{border-bottom:none;}
.activity-time{font-family:var(--mono);font-size:9px;color:var(--text3);min-width:80px;flex-shrink:0;padding-top:1px;}
.activity-text{font-size:12px;color:var(--text2);line-height:1.4;}
.activity-tag{font-family:var(--mono);font-size:9px;padding:1px 6px;border-radius:2px;margin-top:3px;display:inline-block;}

/* localStorage health */
.health-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px;}
.health-item{background:var(--panel);border:1px solid var(--border);padding:12px 14px;display:flex;gap:10px;align-items:center;}
.health-status{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.health-key{font-family:var(--mono);font-size:10px;color:var(--text2);flex:1;word-break:break-all;}
.health-size{font-family:var(--mono);font-size:9px;color:var(--text3);}

/* Footer */
.footer{text-align:center;padding:24px;font-family:var(--mono);font-size:10px;color:var(--text3);letter-spacing:.1em;border-top:1px solid var(--border);margin-top:16px;}

.toast{position:fixed;bottom:20px;right:20px;background:var(--panel);border:1px solid var(--cyan);color:var(--cyan);font-family:var(--mono);font-size:11px;padding:10px 16px;opacity:0;transform:translateY(8px);transition:all .25s;pointer-events:none;z-index:9998;}
.toast.show{opacity:1;transform:translateY(0);}

::-webkit-scrollbar{width:4px;}::-webkit-scrollbar-track{background:transparent;}::-webkit-scrollbar-thumb{background:var(--border2);}
</style>
</head>
<body>

<div class="hdr">
  <div class="hdr-logo">K</div>
  <div class="hdr-org">
    <div class="hdr-org-main">æµ·è•æ©Ÿé–¢</div>
    <div class="hdr-org-sub">ADMIN CONTROL HUB</div>
  </div>
  <div class="hdr-sep"></div>
  <div class="hdr-status">
    <div class="hdr-status-dot"></div>
    <div class="hdr-status-txt">SYSTEM ONLINE</div>
  </div>
  <div class="hdr-time" id="clock"></div>
</div>

<div class="layout">

  <!-- Status Strip -->
  <div class="status-strip" id="statusStrip">
    <div class="status-item">
      <div class="status-val" style="color:var(--cyan)" id="st_users">â€”</div>
      <div class="status-lbl">ç™»éŒ²æ©Ÿé–¢å“¡</div>
    </div>
    <div class="status-item">
      <div class="status-val" style="color:var(--green)" id="st_lv5">â€”</div>
      <div class="status-lbl">LV5åˆ°é”</div>
    </div>
    <div class="status-item">
      <div class="status-val" style="color:var(--yellow)" id="st_messages">â€”</div>
      <div class="status-lbl">ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</div>
    </div>
    <div class="status-item">
      <div class="status-val" style="color:var(--purple)" id="st_story">â€”</div>
      <div class="status-lbl">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ãƒ©ã‚°ON</div>
    </div>
    <div class="status-item">
      <div class="status-val" style="color:var(--orange)" id="st_incidents">â€”</div>
      <div class="status-lbl">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–äº‹æ¡ˆ</div>
    </div>
    <div class="status-item">
      <div class="status-val" style="color:var(--red)" id="st_anomaly">â€”</div>
      <div class="status-lbl">æœ€é«˜ç•°å¸¸ã‚¹ã‚³ã‚¢</div>
    </div>
  </div>

  <!-- Data Management -->
  <div class="section">
    <div class="section-header">
      <div class="section-line" style="background:var(--cyan)"></div>
      <div class="section-title" style="color:var(--cyan)">ãƒ‡ãƒ¼ã‚¿ç®¡ç†</div>
    </div>
    <div class="tool-grid">
      <a class="tool-card" style="--accent:var(--cyan)" href="./player-admin.html">
        <div class="tool-card-icon">ğŸ‘¤</div>
        <div class="tool-card-title">æ©Ÿé–¢å“¡ç®¡ç†</div>
        <div class="tool-card-desc">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®XPãƒ»ãƒ¬ãƒ™ãƒ«ãƒ»éƒ¨é–€ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼çŠ¶æ…‹ã‚’ç›´æ¥ç·¨é›†</div>
      </a>
      <a class="tool-card" style="--accent:var(--blue)" href="./kaishoku-json-editor.html">
        <div class="tool-card-icon">ğŸ“</div>
        <div class="tool-card-title">JSONãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ‡ã‚£ã‚¿</div>
        <div class="tool-card-desc">å®Ÿä½“ãƒ»ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»è·å“¡ãƒ»ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®ç·¨é›†</div>
      </a>
      <a class="tool-card" style="--accent:var(--red)" href="./classified-editor.html">
        <div class="tool-card-new">NEW</div>
        <div class="tool-card-icon">ğŸ”</div>
        <div class="tool-card-title">æ©Ÿå¯†æ–‡æ›¸ã‚¨ãƒ‡ã‚£ã‚¿</div>
        <div class="tool-card-desc">LEVEL5å°‚ç”¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ»æ©Ÿå¯†æ–‡æ›¸ã®ä½œæˆãƒ»ãƒ•ãƒ©ã‚°é€£å‹•è¨­å®š</div>
      </a>
      <a class="tool-card" style="--accent:var(--orange)" href="./map-admin.html">
        <div class="tool-card-icon">ğŸ—º</div>
        <div class="tool-card-title">ãƒãƒƒãƒ—ç®¡ç†</div>
        <div class="tool-card-desc">ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒ”ãƒ³ã®ä½ç½®ãƒ»é‡å¤§åº¦ãƒ»æ‹…å½“éƒ¨é–€ã‚’ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç·¨é›†</div>
      </a>
    </div>
  </div>

  <!-- Game Design -->
  <div class="section">
    <div class="section-header">
      <div class="section-line" style="background:var(--yellow)"></div>
      <div class="section-title" style="color:var(--yellow)">ã‚²ãƒ¼ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³</div>
    </div>
    <div class="tool-grid">
      <a class="tool-card" style="--accent:var(--yellow)" href="./balance-editor.html">
        <div class="tool-card-icon">âš–</div>
        <div class="tool-card-title">ã‚²ãƒ¼ãƒ ãƒãƒ©ãƒ³ã‚¹èª¿æ•´</div>
        <div class="tool-card-desc">ãƒ¬ãƒ™ãƒ«é–¾å€¤ãƒ»XPå ±é…¬ãƒ»ãƒ‡ã‚¤ãƒªãƒ¼ãƒœãƒ¼ãƒŠã‚¹ã‚’ã‚°ãƒ©ãƒ•ä»˜ãã§èª¿æ•´</div>
      </a>
      <a class="tool-card" style="--accent:var(--purple)" href="./message-editor.html">
        <div class="tool-card-icon">âœ</div>
        <div class="tool-card-title">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†</div>
        <div class="tool-card-desc">ãƒ©ãƒ³ã‚¯åãƒ»ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ»ãƒ’ãƒ³ãƒˆãƒ»ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç·¨é›†</div>
      </a>
      <a class="tool-card" style="--accent:var(--green)" href="./qa-checker.html">
        <div class="tool-card-new">NEW</div>
        <div class="tool-card-icon">âœ“</div>
        <div class="tool-card-title">QAãƒã‚§ãƒƒã‚«ãƒ¼</div>
        <div class="tool-card-desc">ãƒ¬ãƒ™ãƒ«ãƒ»ãƒ•ãƒ©ã‚°ã‚’è¨­å®šã—ã¦ã€Œã“ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ä½•ãŒè¦‹ãˆã‚‹ã‹ã€ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
      </a>
    </div>
  </div>

  <!-- ARG / Story -->
  <div class="section">
    <div class="section-header">
      <div class="section-line" style="background:var(--purple)"></div>
      <div class="section-title" style="color:var(--purple)">ARG / ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</div>
    </div>
    <div class="tool-grid">
      <a class="tool-card" style="--accent:var(--purple)" href="./story-admin.html">
        <div class="tool-card-icon">âš¡</div>
        <div class="tool-card-title">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ç®¡ç†</div>
        <div class="tool-card-desc">ARGã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒ•ãƒ©ã‚°ãƒ»ãƒˆãƒªã‚¬ãƒ¼ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†</div>
      </a>
      <a class="tool-card" style="--accent:var(--purple)" href="./chat-viewer.html">
        <div class="tool-card-new">NEW</div>
        <div class="tool-card-icon">ğŸ’¬</div>
        <div class="tool-card-title">ãƒãƒ£ãƒƒãƒˆãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢</div>
        <div class="tool-card-desc">ARGã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤ãƒ»ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</div>
      </a>
    </div>
  </div>

  <!-- System / Console -->
  <div class="section">
    <div class="section-header">
      <div class="section-line" style="background:var(--green)"></div>
      <div class="section-title" style="color:var(--green)">ã‚·ã‚¹ãƒ†ãƒ </div>
    </div>
    <div class="tool-grid">
      <a class="tool-card" style="--accent:var(--green)" href="./console-admin.html">
        <div class="tool-card-icon">âŒ¨</div>
        <div class="tool-card-title">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç®¡ç†</div>
        <div class="tool-card-desc">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç®¡ç†</div>
      </a>
    </div>
  </div>

  <!-- localStorage Health -->
  <div class="section">
    <div class="section-header">
      <div class="section-line" style="background:var(--text3)"></div>
      <div class="section-title" style="color:var(--text3)">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çŠ¶æ…‹</div>
      <button onclick="refreshHealth()" style="margin-left:auto;background:none;border:1px solid var(--border2);color:var(--text3);font-family:var(--mono);font-size:9px;padding:3px 10px;cursor:pointer;letter-spacing:.06em;">â†º æ›´æ–°</button>
    </div>
    <div class="health-grid" id="healthGrid"></div>
  </div>

  <div class="footer">KAISHOKU AGENCY // ADMIN CONTROL HUB // ALL SYSTEMS NOMINAL</div>
</div>

<div class="toast" id="toastEl"></div>

<script>
const LS_KEYS = [
  'kaishoku_current_user','kaishoku_users','kaishoku_messages',
  'kaishoku_progress','kaishoku_story_state','kaishoku_view_history',
  'kaishoku_bookmarks','kaishoku_reports','kaishoku_secret_salt',
  'kaishoku_progress_config_override','kaishoku_level_messages_override',
  'kaishoku_map_incidents_override','kaishoku_area_incidents_override',
  'kaishoku_classified_docs',
];

function updateClock() {
  document.getElementById('clock').textContent = new Date().toLocaleString('ja-JP');
}

function refreshStats() {
  // Users
  try {
    const users = JSON.parse(localStorage.getItem('kaishoku_users')||'[]');
    document.getElementById('st_users').textContent = users.length;
    const prog = JSON.parse(localStorage.getItem('kaishoku_progress')||'{}');
    let lv5 = 0;
    users.forEach(u => { if ((prog[u.id]?.level||0) >= 5) lv5++; });
    document.getElementById('st_lv5').textContent = lv5;
  } catch(e) { document.getElementById('st_users').textContent='err'; }

  // Messages
  try {
    const msgs = JSON.parse(localStorage.getItem('kaishoku_messages')||'{}');
    const total = Object.values(msgs).reduce((s,a)=>s+a.length,0);
    document.getElementById('st_messages').textContent = total;
  } catch(e) { document.getElementById('st_messages').textContent='0'; }

  // Story
  try {
    const state = JSON.parse(localStorage.getItem('kaishoku_story_state')||'{}');
    const flags = state.flags||{};
    const on = Object.values(flags).filter(Boolean).length;
    document.getElementById('st_story').textContent = on;
    const anomaly = state.variables?.anomaly_score || 0;
    document.getElementById('st_anomaly').textContent = anomaly;
  } catch(e) { document.getElementById('st_story').textContent='0'; }

  // Incidents
  try {
    const inc = JSON.parse(localStorage.getItem('kaishoku_map_incidents_override')||'null');
    const active = inc ? inc.incidents.filter(i=>i.status==='å¯¾å¿œä¸­').length : 'â€”';
    document.getElementById('st_incidents').textContent = active;
  } catch(e) { document.getElementById('st_incidents').textContent='â€”'; }
}

function refreshHealth() {
  const el = document.getElementById('healthGrid');
  el.innerHTML = LS_KEYS.map(key => {
    const val = localStorage.getItem(key);
    const exists = val !== null;
    const size = val ? new Blob([val]).size : 0;
    const sizeStr = size > 1024 ? (size/1024).toFixed(1)+'KB' : size+'B';
    return `<div class="health-item">
      <div class="health-status" style="background:${exists?'var(--green)':'var(--border2)'};box-shadow:${exists?'0 0 4px var(--green)':'none'}"></div>
      <div class="health-key">${key.replace('kaishoku_','')}</div>
      ${exists?`<div class="health-size">${sizeStr}</div>`:'<div class="health-size" style="color:var(--text3)">æœªè¨­å®š</div>'}
    </div>`;
  }).join('');
}

updateClock();
setInterval(updateClock, 1000);
refreshStats();
setInterval(refreshStats, 5000);
refreshHealth();
</script>
</body>
</html>